<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Simple maximum likelihood estimation — smle • epiphy</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Simple maximum likelihood estimation — smle" />

<meta property="og:description" content="By default, this function performs a maximum likelihood estimation for one or
several parameters, but it can be used for any other optimization problems.
The interface is intented to be rather simple while allowing more advanced
parametrizations." />
<meta name="twitter:card" content="summary" />


<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">epiphy</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">0.3.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/defs-and-eqns.html">Definitions and relationships between parameters</a>
    </li>
    <li>
      <a href="../articles/intro.html">Analyzing plant disease epidemics with the R package epiphy</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Simple maximum likelihood estimation</h1>
    
    <div class="hidden name"><code>smle.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>By default, this function performs a maximum likelihood estimation for one or
several parameters, but it can be used for any other optimization problems.
The interface is intented to be rather simple while allowing more advanced
parametrizations.</p>
    
    </div>

    <pre class="usage"><span class='fu'>smle</span>(<span class='no'>data</span>, <span class='no'>...</span>)

<span class='co'># S3 method for default</span>
<span class='fu'>smle</span>(<span class='no'>data</span>, <span class='no'>f</span>, <span class='no'>param_init</span>, <span class='kw'>max</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='no'>...</span>)

<span class='co'># S3 method for intensity</span>
<span class='fu'>smle</span>(<span class='no'>data</span>, <span class='no'>f</span>, <span class='no'>param_init</span>, <span class='kw'>max</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='no'>...</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>data</th>
      <td><p>The data set to work with. It can be a vector (if there is only
one variable), a data frame (if there is one or more variables) or an
<code><a href='intensity.html'>intensity</a></code> object.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Additional arguments to be passed to <code><a href='http://www.rdocumentation.org/packages/stats/topics/optim'>optim</a></code>.</p></td>
    </tr>
    <tr>
      <th>f</th>
      <td><p>A function to be maximized, typically a log-likelihood function.
This function must have only two arguments: <code>data</code> and <code>param</code>,
which must correspond to the <code>data</code> argument of <code>smle</code> and a
named vector of the parameter(s) to be estimated.</p></td>
    </tr>
    <tr>
      <th>param_init</th>
      <td><p>Either a named vector with proposed initial values of the
parameter(s), or a function that returns such a vector. This parameter
is not needed if the parameter <code>param</code> of <code>f</code> is already
provided with such a named vector.</p></td>
    </tr>
    <tr>
      <th>max</th>
      <td><p>Does <code>f</code> need to be maximized? Set to <code>FALSE</code> to require
a minimization of <code>f</code>.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The <code><a href='http://www.rdocumentation.org/packages/stats/topics/optim'>optim</a></code> tool does the hard work under the hood. Extra
arguments (e.g. method of optimization to be used) can be passed to
<code><a href='http://www.rdocumentation.org/packages/stats/topics/optim'>optim</a></code> through the <code>...</code> argument. Note that
contrary to the default <code><a href='http://www.rdocumentation.org/packages/stats/topics/optim'>optim</a></code> arguments, <code>smle</code>
tries to solve a maximization problem using the method "L-BFGS-B" by default
(see <code><a href='http://www.rdocumentation.org/packages/stats/topics/optim'>optim</a></code> documentation for more information).</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'>set.seed</span>(<span class='fl'>12345</span>)
<span class='no'>data</span> <span class='kw'>&lt;-</span> <span class='fu'>rlogis</span>(<span class='fl'>100</span>, <span class='kw'>location</span> <span class='kw'>=</span> <span class='fl'>5</span>, <span class='kw'>scale</span> <span class='kw'>=</span> <span class='fl'>2</span>)
<span class='no'>ll_logis</span> <span class='kw'>&lt;-</span> <span class='kw'>function</span>(<span class='no'>data</span>, <span class='no'>param</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='kw'>location</span> <span class='kw'>=</span> <span class='fl'>0</span>, <span class='kw'>scale</span> <span class='kw'>=</span> <span class='fl'>1</span>)) {
    <span class='fu'>sum</span>(<span class='fu'>dlogis</span>(<span class='kw'>x</span> <span class='kw'>=</span> <span class='no'>data</span>, <span class='kw'>location</span> <span class='kw'>=</span> <span class='no'>param</span><span class='kw'>[[</span><span class='st'>"location"</span>]],
               <span class='kw'>scale</span> <span class='kw'>=</span> <span class='no'>param</span><span class='kw'>[[</span><span class='st'>"scale"</span>]], <span class='kw'>log</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>))
}
<span class='no'>res</span> <span class='kw'>&lt;-</span> <span class='fu'>smle</span>(<span class='no'>data</span>, <span class='no'>ll_logis</span>)
<span class='no'>res</span></div><div class='output co'>#&gt; location: 5.111 (± 0.3764)
#&gt; scale: 2.179 (± 0.183)</div><div class='input'><span class='fu'>summary</span>(<span class='no'>res</span>)</div><div class='output co'>#&gt; Maximum likelihood estimation
#&gt; 
#&gt; Call:
#&gt; smle.default(data = data, f = ll_logis)
#&gt; 
#&gt; Coefficients:
#&gt;          Estimate Std.Err Z value    Pr(&gt;z)    
#&gt; location  5.11143 0.37642  13.579 &lt; 2.2e-16 ***
#&gt; scale     2.17878 0.18297  11.908 &lt; 2.2e-16 ***
#&gt; ---
#&gt; Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</div><div class='input'>
<span class='co'># Using the magrittr syntax:</span>
<span class='fu'>require</span>(<span class='no'>magrittr</span>)
<span class='no'>data</span> <span class='kw'>%&gt;%</span> <span class='fu'>smle</span>(<span class='no'>ll_logis</span>)</div><div class='output co'>#&gt; location: 5.111 (± 0.3764)
#&gt; scale: 2.179 (± 0.183)</div><div class='input'>
<span class='co'># Comparision with the output of fitdistr (MASS package), which works for a</span>
<span class='co'># limited number of predefined distributions:</span>
<span class='fu'>require</span>(<span class='no'>MASS</span>)
<span class='fu'><a href='http://www.rdocumentation.org/packages/MASS/topics/fitdistr'>fitdistr</a></span>(<span class='no'>data</span>, <span class='st'>"logistic"</span>)</div><div class='output co'>#&gt;    location      scale  
#&gt;   5.1114264   2.1787668 
#&gt;  (0.3764149) (0.1829733)</div><div class='input'>
<span class='co'># Example with an intensity object:</span>
<span class='fu'>require</span>(<span class='no'>magrittr</span>)
<span class='fu'>require</span>(<span class='no'>dplyr</span>)</div><div class='output co'>#&gt; <span class='message'>Loading required package: dplyr</span></div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>Attaching package: ‘dplyr’</span></div><div class='output co'>#&gt; <span class='message'>The following object is masked from ‘package:MASS’:</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>    select</span></div><div class='output co'>#&gt; <span class='message'>The following object is masked from ‘package:epiphy’:</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>    count</span></div><div class='output co'>#&gt; <span class='message'>The following objects are masked from ‘package:stats’:</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>    filter, lag</span></div><div class='output co'>#&gt; <span class='message'>The following objects are masked from ‘package:base’:</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>    intersect, setdiff, setequal, union</span></div><div class='input'><span class='no'>data</span> <span class='kw'>&lt;-</span> <span class='no'>tomato_tswv</span>$<span class='no'>field_1929</span> <span class='kw'>%&gt;%</span>
    <span class='fu'><a href='http://dplyr.tidyverse.org/reference/filter.html'>filter</a></span>(<span class='no'>t</span> <span class='kw'>==</span> <span class='fl'>1</span>) <span class='kw'>%&gt;%</span>
    <span class='fu'><a href='intensity.html'>incidence</a></span>() <span class='kw'>%&gt;%</span>
    <span class='fu'><a href='clump.html'>clump</a></span>(<span class='kw'>unit_size</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='kw'>x</span> <span class='kw'>=</span> <span class='fl'>3</span>, <span class='kw'>y</span> <span class='kw'>=</span> <span class='fl'>3</span>))
<span class='no'>ll_betabinom</span> <span class='kw'>&lt;-</span> <span class='kw'>function</span>(<span class='no'>data</span>, <span class='no'>param</span>) {
    <span class='fu'>sum</span>(<span class='fu'><a href='BetaBinomial.html'>dbetabinom</a></span>(<span class='kw'>x</span> <span class='kw'>=</span> <span class='no'>data</span><span class='kw'>[[</span><span class='st'>"i"</span>]], <span class='kw'>size</span> <span class='kw'>=</span> <span class='no'>data</span><span class='kw'>[[</span><span class='st'>"n"</span>]],
                   <span class='kw'>prob</span> <span class='kw'>=</span> <span class='no'>param</span><span class='kw'>[[</span><span class='st'>"prob"</span>]], <span class='kw'>theta</span> <span class='kw'>=</span> <span class='no'>param</span><span class='kw'>[[</span><span class='st'>"theta"</span>]],
                   <span class='kw'>log</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>))
}
<span class='no'>epsilon</span> <span class='kw'>&lt;-</span> <span class='fl'>1e-7</span>
<span class='no'>res</span> <span class='kw'>&lt;-</span> <span class='fu'>smle</span>(<span class='no'>data</span>, <span class='no'>ll_betabinom</span>, <span class='kw'>param_init</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='kw'>prob</span> <span class='kw'>=</span> <span class='fl'>0.5</span>, <span class='kw'>theta</span> <span class='kw'>=</span> <span class='fl'>0.5</span>),
            <span class='kw'>lower</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='kw'>prob</span>  <span class='kw'>=</span> <span class='fl'>0</span> + <span class='no'>epsilon</span>,
                      <span class='kw'>theta</span> <span class='kw'>=</span> <span class='fl'>0</span> + <span class='no'>epsilon</span>),
            <span class='kw'>upper</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='kw'>prob</span> <span class='kw'>=</span> <span class='fl'>1</span> - <span class='no'>epsilon</span>,
                      <span class='kw'>theta</span> <span class='kw'>=</span> <span class='fl'>Inf</span>))
<span class='no'>res</span></div><div class='output co'>#&gt; prob: 0.1813 (± 0.01191)
#&gt; theta: 0.04939 (± 0.01976)</div><div class='input'><span class='fu'>summary</span>(<span class='no'>res</span>)</div><div class='output co'>#&gt; Maximum likelihood estimation
#&gt; 
#&gt; Call:
#&gt; smle.intensity(data = data, f = ll_betabinom, param_init = c(prob = 0.5, 
#&gt;     theta = 0.5), lower = c(prob = 0 + epsilon, theta = 0 + epsilon), 
#&gt;     upper = c(prob = 1 - epsilon, theta = Inf))
#&gt; 
#&gt; Coefficients:
#&gt;       Estimate  Std.Err Z value  Pr(&gt;z)    
#&gt; prob  0.181326 0.011913 15.2204 &lt; 2e-16 ***
#&gt; theta 0.049393 0.019759  2.4997 0.01243 *  
#&gt; ---
#&gt; Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</div><div class='input'>
<span class='no'>param_init</span> <span class='kw'>&lt;-</span> <span class='fu'>data.frame</span>(<span class='kw'>lower</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='fl'>0</span> + <span class='no'>epsilon</span>, <span class='fl'>0</span> + <span class='no'>epsilon</span>),
                         <span class='kw'>start</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='fl'>0.5</span>, <span class='fl'>0.5</span>),
                         <span class='kw'>upper</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='fl'>1</span> - <span class='no'>epsilon</span>, <span class='fl'>Inf</span>))
<span class='fu'>rownames</span>(<span class='no'>param_init</span>) <span class='kw'>&lt;-</span> <span class='fu'>c</span>(<span class='st'>"prob"</span>, <span class='st'>"theta"</span>)
<span class='no'>res</span> <span class='kw'>&lt;-</span> <span class='fu'>smle</span>(<span class='no'>data</span>, <span class='no'>ll_betabinom</span>, <span class='no'>param_init</span>)
<span class='no'>res</span></div><div class='output co'>#&gt; prob: 0.1813 (± 0.01191)
#&gt; theta: 0.04939 (± 0.01976)</div><div class='input'><span class='fu'>summary</span>(<span class='no'>res</span>)</div><div class='output co'>#&gt; Maximum likelihood estimation
#&gt; 
#&gt; Call:
#&gt; smle.intensity(data = data, f = ll_betabinom, param_init = param_init)
#&gt; 
#&gt; Coefficients:
#&gt;       Estimate  Std.Err Z value  Pr(&gt;z)    
#&gt; prob  0.181326 0.011913 15.2204 &lt; 2e-16 ***
#&gt; theta 0.049393 0.019759  2.4997 0.01243 *  
#&gt; ---
#&gt; Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#details">Details</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Christophe Gigot.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  

  </body>
</html>

