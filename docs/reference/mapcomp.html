<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Map Comparison procedure. — mapcomp • epiphy</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Map Comparison procedure. — mapcomp" />

<meta property="og:description" content="mapcomp performs a spatial pattern analysis based on the calculation
of a formal distance (the Hellinger distance) between the density map of
count or incidence data, and the density map of sampling effort. Statistical
tests of spatial homogeneity are based on permutations across sampling sites
and on valuable properties of the Hellinger distance." />

<meta property="og:image" content="/logo.png" />
<meta name="twitter:card" content="summary" />


<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">epiphy</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">0.3.4.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../articles/epiphy.html">Primer</a>
</li>
<li>
  <a href="../reference/index.html">Functions and data</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/defs-and-eqns.html">Definitions and relationships between parameters</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/chgigot/epiphy">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Map Comparison procedure.</h1>
    <small class="dont-index">Source: <a href='https://github.com/chgigot/epiphy/blob/master/R/mapcomp.R'><code>R/mapcomp.R</code></a></small>
    <div class="hidden name"><code>mapcomp.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p><code>mapcomp</code> performs a spatial pattern analysis based on the calculation
of a formal distance (the Hellinger distance) between the density map of
count or incidence data, and the density map of sampling effort. Statistical
tests of spatial homogeneity are based on permutations across sampling sites
and on valuable properties of the Hellinger distance.</p>
    
    </div>

    <pre class="usage"><span class='fu'>mapcomp</span>(<span class='no'>data</span>, <span class='no'>...</span>)

<span class='co'># S3 method for data.frame</span>
<span class='fu'>mapcomp</span>(<span class='no'>data</span>, <span class='no'>delta</span>, <span class='no'>bandwidth</span>, <span class='kw'>nperm</span> <span class='kw'>=</span> <span class='fl'>100</span>,
  <span class='kw'>edge_correction</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>threads</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>verbose</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='no'>...</span>)

<span class='co'># S3 method for matrix</span>
<span class='fu'>mapcomp</span>(<span class='no'>data</span>, <span class='no'>delta</span>, <span class='no'>bandwidth</span>, <span class='kw'>nperm</span> <span class='kw'>=</span> <span class='fl'>100</span>,
  <span class='kw'>edge_correction</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>threads</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>verbose</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='no'>...</span>)

<span class='co'># S3 method for count</span>
<span class='fu'>mapcomp</span>(<span class='no'>data</span>, <span class='no'>delta</span>, <span class='no'>bandwidth</span>, <span class='kw'>nperm</span> <span class='kw'>=</span> <span class='fl'>100</span>,
  <span class='kw'>edge_correction</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>threads</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>verbose</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='no'>...</span>)

<span class='co'># S3 method for incidence</span>
<span class='fu'>mapcomp</span>(<span class='no'>data</span>, <span class='no'>delta</span>, <span class='no'>bandwidth</span>, <span class='kw'>nperm</span> <span class='kw'>=</span> <span class='fl'>100</span>,
  <span class='kw'>edge_correction</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>threads</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>verbose</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='no'>...</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>data</th>
      <td><p>A data frame or a matrix with only three columns: the two first
ones must be the x and y coordinates of the sampling units, and the last
one, the corresponding disease intensity observations. It can also be a
<code><a href='intensity.html'>count</a></code> or an <code><a href='intensity.html'>incidence</a></code> object.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Additional arguments to be passed to other methods.</p></td>
    </tr>
    <tr>
      <th>delta</th>
      <td><p>Mesh size of the grid over the geographical domain of the
sampling units used to compute the integral Hellinger distance between
the probability density function of observations and the probability
density function of sampling effort.</p></td>
    </tr>
    <tr>
      <th>bandwidth</th>
      <td><p>Bandwidth parameter for smoothing. It allows to test the
spatial extent of heterogeneity if any.</p></td>
    </tr>
    <tr>
      <th>nperm</th>
      <td><p>Number of random permutations to assess probabilities.</p></td>
    </tr>
    <tr>
      <th>edge_correction</th>
      <td><p>Apply edge correction to account for the fact that
bordering points intrinsically suffer from a lack of neighboring
observation sites. FALSE by default.</p></td>
    </tr>
    <tr>
      <th>threads</th>
      <td><p>Number of threads to perform the computations.</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>Explain what is being done (TRUE by default).</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Lavigne C, Ricci B, Franck P, Senoussi R. 2010. Spatial analyses of
ecological count data: A density map comparison approach. Basic and Applied
Ecology. 11:734–742.</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'>set.seed</span>(<span class='fl'>123</span>)
<span class='no'>my_res</span> <span class='kw'>&lt;-</span> <span class='fu'>mapcomp</span>(<span class='no'>codling_moths</span>, <span class='kw'>delta</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>bandwidth</span> <span class='kw'>=</span> <span class='fl'>11</span>,
                  <span class='kw'>edge_correction</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>nperm</span> <span class='kw'>=</span> <span class='fl'>20</span>)</div><div class='output co'>#&gt;    |                                                  | 0 % ~calculating     |+++                                               | 5 % ~08s             |+++++                                             | 10% ~05s             |++++++++                                          | 15% ~03s             |++++++++++                                        | 20% ~02s             |+++++++++++++                                     | 25% ~02s             |+++++++++++++++                                   | 30% ~02s             |++++++++++++++++++                                | 35% ~01s             |++++++++++++++++++++                              | 40% ~01s             |+++++++++++++++++++++++                           | 45% ~01s             |+++++++++++++++++++++++++                         | 50% ~01s             |++++++++++++++++++++++++++++                      | 55% ~01s             |++++++++++++++++++++++++++++++                    | 60% ~01s             |+++++++++++++++++++++++++++++++++                 | 65% ~01s             |+++++++++++++++++++++++++++++++++++               | 70% ~00s             |++++++++++++++++++++++++++++++++++++++            | 75% ~00s             |++++++++++++++++++++++++++++++++++++++++         | 80% ~00s             |+++++++++++++++++++++++++++++++++++++++++++       | 85% ~00s             |+++++++++++++++++++++++++++++++++++++++++++++    | 90% ~00s             |++++++++++++++++++++++++++++++++++++++++++++++++  | 95% ~00s             |++++++++++++++++++++++++++++++++++++++++++++++++++| 100% elapsed = 01s</div><div class='input'><span class='no'>my_res</span></div><div class='output co'>#&gt; Map Comparison analysis (mapcomp)
#&gt; 
#&gt; Call:
#&gt; mapcomp.data.frame(data = codling_moths, delta = 1, bandwidth = 11, 
#&gt;     nperm = 20, edge_correction = FALSE)
#&gt; 
#&gt; Stat: 0.3423 (P = 0.047619)
#&gt; </div><div class='input'><span class='fu'>plot</span>(<span class='no'>my_res</span>)</div><div class='img'><img src='mapcomp-1.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='fu'>set.seed</span>(<span class='fl'>123</span>)
<span class='no'>my_count</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='intensity.html'>count</a></span>(<span class='no'>codling_moths</span>, <span class='fu'><a href='mapping.html'>mapping</a></span>(<span class='kw'>x</span> <span class='kw'>=</span> <span class='no'>xm</span>, <span class='kw'>y</span> <span class='kw'>=</span> <span class='no'>ym</span>))
<span class='no'>my_res</span> <span class='kw'>&lt;-</span> <span class='fu'>mapcomp</span>(<span class='no'>my_count</span>, <span class='kw'>delta</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>bandwidth</span> <span class='kw'>=</span> <span class='fl'>11</span>,
                  <span class='kw'>edge_correction</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>nperm</span> <span class='kw'>=</span> <span class='fl'>20</span>)</div><div class='output co'>#&gt;    |                                                  | 0 % ~calculating     |+++                                               | 5 % ~01s             |+++++                                             | 10% ~01s             |++++++++                                          | 15% ~01s             |++++++++++                                        | 20% ~01s             |+++++++++++++                                     | 25% ~01s             |+++++++++++++++                                   | 30% ~01s             |++++++++++++++++++                                | 35% ~01s             |++++++++++++++++++++                              | 40% ~01s             |+++++++++++++++++++++++                           | 45% ~01s             |+++++++++++++++++++++++++                         | 50% ~01s             |++++++++++++++++++++++++++++                      | 55% ~00s             |++++++++++++++++++++++++++++++                    | 60% ~00s             |+++++++++++++++++++++++++++++++++                 | 65% ~00s             |+++++++++++++++++++++++++++++++++++               | 70% ~00s             |++++++++++++++++++++++++++++++++++++++            | 75% ~00s             |++++++++++++++++++++++++++++++++++++++++         | 80% ~00s             |+++++++++++++++++++++++++++++++++++++++++++       | 85% ~00s             |+++++++++++++++++++++++++++++++++++++++++++++    | 90% ~00s             |++++++++++++++++++++++++++++++++++++++++++++++++  | 95% ~00s             |++++++++++++++++++++++++++++++++++++++++++++++++++| 100% elapsed = 01s</div><div class='input'><span class='no'>my_res</span></div><div class='output co'>#&gt; Map Comparison analysis (mapcomp)
#&gt; 
#&gt; Call:
#&gt; mapcomp.count(data = my_count, delta = 1, bandwidth = 11, nperm = 20, 
#&gt;     edge_correction = FALSE)
#&gt; 
#&gt; Stat: 0.3423 (P = 0.047619)
#&gt; </div><div class='input'><span class='fu'>plot</span>(<span class='no'>my_res</span>, <span class='kw'>bins</span> <span class='kw'>=</span> <span class='fl'>10</span>)</div><div class='img'><img src='mapcomp-2.png' alt='' width='700' height='433' /></div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#references">References</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Christophe Gigot.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  

  </body>
</html>

